import{s,f as c,a as m,b as d}from"./index-BP0JQ-U7.js";const g=async()=>{const{data:e,error:a}=await s.from("Cabins").select("Name,id,image,maxCapacity,regularPrice,discount,description");if(a)throw console.error(a),new a("Cabins could not be loaded");return e},f=async e=>{const a=`${Math.random()}=${e.image.name}`.replaceAll("/",""),r=`${c}/storage/v1/object/public/Cabins/${a}`,{data:t,error:o}=await s.from("Cabins").insert([{...e,image:r}]).select();if(o)throw new Error(o==null?void 0:o.message);const{error:i}=await s.storage.from("Cabins").upload(a,e.image);if(i)throw await s.from("Cabins").delete().eq("id",t.id),console.log("err in uploading img"),new Error("err in uploading img ");return t},b=async e=>{const{data:a,error:r}=await s.from("Cabins").delete().eq("id",e);if(r)throw console.error(r),new r("Cabin could not be Deleted");return a},p=async(e,a)=>{let r=e.image;if(e.image instanceof File){const n=`${Math.random()}-${e.image.name}`.replaceAll("/","");r=`${c}/storage/v1/object/public/Cabins/${n}`;const{error:l}=await s.storage.from("Cabins").upload(n,e.image);if(l)throw new Error("Failed to upload the new cabin image")}const t={...e};e.image instanceof File?t.image=r:delete t.image;const{data:o,error:i}=await s.from("Cabins").update(t).eq("id",a).select().single();if(i)throw new Error(i.message||"Failed to update cabin");return o};function h(){const e=m.c(5);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={queryKey:["cabins"],queryFn:g,staleTime:2e4,cacheTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!1},e[0]=a):a=e[0];const{data:r,isLoading:t,error:o}=d(a);let i;return e[1]!==r||e[2]!==o||e[3]!==t?(i={cabins:r,isLoading:t,error:o},e[1]=r,e[2]=o,e[3]=t,e[4]=i):i=e[4],i}export{f as A,p as E,b as d,h as u};
