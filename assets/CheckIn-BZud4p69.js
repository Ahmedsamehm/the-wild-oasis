import{a as B,e as E,d as q,V as I,r as _,j as n,L as y,h as A}from"./index-BP0JQ-U7.js";import{B as K,u as R}from"./useGetSpecificBook-BIXbDNXb.js";import{u as G}from"./useMutation-EI1e8LqR.js";import{a as Q,u as V}from"./useBooking-BTVaXZaQ.js";import{u as M}from"./useDeleteBook-CR7q5Ku2.js";import{a as W}from"./useGetSetting-B1fzKQ5q.js";function w(){const s=B.c(7),t=E(),a=q();let e;s[0]!==a||s[1]!==t?(e={mutationFn:z,onSuccess:()=>{I.success("Checked in successfully"),t.invalidateQueries({queryKey:["bookings"]}),a("/Booking")},onError(l){I.error(l.message)}},s[0]=a,s[1]=t,s[2]=e):e=s[2];const{mutate:i,isPending:o,error:c}=G(e);let r;return s[3]!==i||s[4]!==c||s[5]!==o?(r={checkInFunc:i,isCheckLoading:o,error:c},s[3]=i,s[4]=c,s[5]=o,s[6]=r):r=s[6],r}function z(s){const{idBooking:t,breakfast:a}=s;return Q(t,{status:"checked-in",isPaid:!0,...a})}function H(){const s=B.c(6),t=E();let a;s[0]!==t?(a={mutationFn:J,onSuccess:()=>{I.success("Checked out successfully"),t.invalidateQueries({queryKey:["bookings"]})},onError(r){I.error(r.message)}},s[0]=t,s[1]=a):a=s[1];const{mutate:e,isPending:i,error:o}=G(a);let c;return s[2]!==o||s[3]!==e||s[4]!==i?(c={CheckOutFunc:e,CheckOutLoading:i,CheckOutErr:o},s[2]=o,s[3]=e,s[4]=i,s[5]=c):c=s[5],c}function J(s){return Q(s,{status:"checked-out"})}function T(s,t,a){const e=B.c(25),[i,o]=_.useState(!1),[c,r]=_.useState(!1),{checkInFunc:l,isCheckLoading:x}=w(),{CheckOutFunc:d,CheckOutLoading:h}=H(),{numNights:g,numGuests:j,totalPrice:N}=s||{},p=a==null?void 0:a.find(U),u=(p?p.breakfastPrice:0)*g*j;let f;e[0]!==i?(f=()=>{o(!i)},e[0]=i,e[1]=f):f=e[1];const C=f;let m;e[2]!==c?(m=()=>{r(!c)},e[2]=c,e[3]=m):m=e[3];const b=m,k=N+u;let $;e[4]!==k||e[5]!==u?($={hasBreakfast:!0,extrasPrice:u,totalPrice:k},e[4]=k,e[5]=u,e[6]=$):$=e[6];const O=$;let L;e[7]!==c||e[8]!==O||e[9]!==l||e[10]!==t?(L=()=>{c&&l({idBooking:t,breakfast:O})},e[7]=c,e[8]=O,e[9]=l,e[10]=t,e[11]=L):L=e[11];const F=L;let v;e[12]!==d||e[13]!==t?(v=()=>{d(t)},e[12]=d,e[13]=t,e[14]=v):v=e[14];const S=v;let D;return e[15]!==h||e[16]!==c||e[17]!==b||e[18]!==F||e[19]!==S||e[20]!==C||e[21]!==x||e[22]!==i||e[23]!==u?(D={payConfirm:i,breakfastConfirm:c,isCheckLoading:x,CheckOutLoading:h,totalBreakfast:u,handlePay:C,handleBreakfast:b,handleCheckIn:F,handleCheckOut:S},e[15]=h,e[16]=c,e[17]=b,e[18]=F,e[19]=S,e[20]=C,e[21]=x,e[22]=i,e[23]=u,e[24]=D):D=e[24],D}function U(s){return s.id===1}function X(s){const t=B.c(20),{BookFound:a,Status:e,idBooking:i,Setting:o,isLoading:c}=s,r=q();let l;t[0]!==a?(l=a||{},t[0]=a,t[1]=l):l=t[1];const{guestID:x,id:d}=l,{DeleteBook:h,DeleteLoading:g}=M(),{payConfirm:j,breakfastConfirm:N,isCheckLoading:p,CheckOutLoading:P,totalBreakfast:u,handlePay:f,handleBreakfast:C,handleCheckIn:m,handleCheckOut:b}=T(a,i,o);let k;return t[2]!==a||t[3]!==P||t[4]!==h||t[5]!==g||t[6]!==e||t[7]!==N||t[8]!==x||t[9]!==C||t[10]!==m||t[11]!==b||t[12]!==f||t[13]!==d||t[14]!==p||t[15]!==c||t[16]!==r||t[17]!==j||t[18]!==u?(k=n.jsx(n.Fragment,{children:c?n.jsx(y,{}):n.jsxs(n.Fragment,{children:[n.jsx(K,{BookFound:a,isLoading:c}),e==="unconfirmed"?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"p-5 bg-neutral mt-4 rounded-xl",children:n.jsxs("div",{children:[n.jsx("input",{type:"checkbox",onChange:C,className:"checkbox"}),n.jsxs("span",{children:["Want to add breakfast for $",u||"N/A"]})]})}),n.jsx("div",{className:"p-5 bg-neutral mt-4 rounded-xl",children:n.jsxs("div",{children:[n.jsx("input",{type:"checkbox",onChange:f,disabled:j,className:"checkbox"}),n.jsxs("span",{children:["I confirm that ",x," has paid the total amount of $",a==null?void 0:a.totalPrice]}),N?n.jsxs("span",{children:["(",a==null?void 0:a.totalPrice,"+",u,") = $",(a==null?void 0:a.totalPrice)+u]}):""]})})]}):null,n.jsxs("div",{className:"flex justify-end mt-3 gap-2",children:[e==="checked-out"&&n.jsx("button",{disabled:g,onClick:()=>{h(d)},className:"btn btn-error ",children:g?n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(y,{})," Deleting..."]}):`Delete ${d}`}),e==="unconfirmed"&&n.jsx(n.Fragment,{children:n.jsx("button",{onClick:m,className:"btn btn-primary",disabled:!j||p,children:p?n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(y,{})," Loading..."]}):`Check-in ${d}`})}),e==="checked-in"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:b,className:"btn btn-primary",disabled:P,children:P?n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(y,{})," Loading..."]}):`Check-out ${d}`}),n.jsx("button",{onClick:()=>{h(d)},className:"btn btn-error",children:g?n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(y,{})," Deleting..."]}):`Delete ${d}`})]}),n.jsx("button",{onClick:()=>r("/Booking"),className:"btn btn-neutral",children:"Back"})]})]})}),t[2]=a,t[3]=P,t[4]=h,t[5]=g,t[6]=e,t[7]=N,t[8]=x,t[9]=C,t[10]=m,t[11]=b,t[12]=f,t[13]=d,t[14]=p,t[15]=c,t[16]=r,t[17]=j,t[18]=u,t[19]=k):k=t[19],k}function ae(){const s=B.c(7),{Bookings:t,isLoading:a}=V(),{Setting:e}=W(),{idBooking:i}=A(),{specificBooking:o,status:c}=R(t,i);if(a||!o){let l;return s[0]===Symbol.for("react.memo_cache_sentinel")?(l=n.jsx(y,{}),s[0]=l):l=s[0],l}let r;return s[1]!==e||s[2]!==i||s[3]!==a||s[4]!==o||s[5]!==c?(r=n.jsx(n.Fragment,{children:n.jsx(X,{Status:c,isLoading:a,BookFound:o,idBooking:i,Setting:e})}),s[1]=e,s[2]=i,s[3]=a,s[4]=o,s[5]=c,s[6]=r):r=s[6],r}export{ae as default};
